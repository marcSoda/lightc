---
source: crates/codegen/src/tests.rs
assertion_line: 433
expression: "(test[1], res, res_opt)"
---
- "\nfn returnStruct() -> Foo {\n    let a: Foo\n    a.a = 1\n    a\n}\nfn main() {\n    let x: Foo\n    x.a\n    let b: Bar\n    b.foo.a = returnStruct().a\n    b.foo.b()\n    b.foo.a\n}\nstruct Foo {\n    let a: int\n    fn b() {}\n}\nstruct Bar {\n    let foo: Foo\n}\n"
- "; ModuleID = 'test'\nsource_filename = \"test\"\n\n%Foo = type { i32 }\n%Bar = type { %Foo }\n\ndefine %Foo @\"_returnStruct~Foo\"() {\nentry:\n  %a = alloca %Foo, align 8\n  store %Foo zeroinitializer, %Foo* %a, align 4\n  %a1 = load %Foo, %Foo* %a, align 4\n  %struct.field.gep = getelementptr inbounds %Foo, %Foo* %a, i32 0, i32 0\n  %struct.0 = load i32, i32* %struct.field.gep, align 4\n  %a2 = load %Foo, %Foo* %a, align 4\n  %struct.field.gep3 = getelementptr inbounds %Foo, %Foo* %a, i32 0, i32 0\n  store i32 1, i32* %struct.field.gep3, align 4\n  %a4 = load %Foo, %Foo* %a, align 4\n  ret %Foo %a4\n}\n\ndefine void @main() {\nentry:\n  %x = alloca %Foo, align 8\n  store %Foo zeroinitializer, %Foo* %x, align 4\n  %x1 = load %Foo, %Foo* %x, align 4\n  %struct.field.gep = getelementptr inbounds %Foo, %Foo* %x, i32 0, i32 0\n  %struct.0 = load i32, i32* %struct.field.gep, align 4\n  %b = alloca %Bar, align 8\n  store %Bar zeroinitializer, %Bar* %b, align 4\n  %b2 = load %Bar, %Bar* %b, align 4\n  %struct.field.gep3 = getelementptr inbounds %Bar, %Bar* %b, i32 0, i32 0\n  %struct.field.gep4 = getelementptr inbounds %Foo, %Foo* %struct.field.gep3, i32 0, i32 0\n  %struct.05 = load i32, i32* %struct.field.gep4, align 4\n  %\"call__returnStruct~Foo\" = call %Foo @\"_returnStruct~Foo\"()\n  %\"_light_intern@1\" = alloca %Foo, align 8\n  store %Foo %\"call__returnStruct~Foo\", %Foo* %\"_light_intern@1\", align 4\n  %struct.field.gep6 = getelementptr inbounds %Foo, %Foo* %\"_light_intern@1\", i32 0, i32 0\n  %struct.07 = load i32, i32* %struct.field.gep6, align 4\n  %b8 = load %Bar, %Bar* %b, align 4\n  %struct.field.gep9 = getelementptr inbounds %Bar, %Bar* %b, i32 0, i32 0\n  %struct.field.gep10 = getelementptr inbounds %Foo, %Foo* %struct.field.gep9, i32 0, i32 0\n  store i32 %struct.07, i32* %struct.field.gep10, align 4\n  call void @\"_Foo_b~void\"()\n  %b11 = load %Bar, %Bar* %b, align 4\n  %struct.field.gep12 = getelementptr inbounds %Bar, %Bar* %b, i32 0, i32 0\n  %struct.field.gep13 = getelementptr inbounds %Foo, %Foo* %struct.field.gep12, i32 0, i32 0\n  %struct.014 = load i32, i32* %struct.field.gep13, align 4\n  ret void\n}\n\ndefine void @\"_Foo_b~void\"() {\nentry:\n  ret void\n}\n"
- "; ModuleID = 'test'\nsource_filename = \"test\"\n\n%Foo = type { i32 }\n\ndefine %Foo @\"_returnStruct~Foo\"() {\nentry:\n  ret %Foo { i32 1 }\n}\n\ndefine void @main() {\nentry:\n  %\"call__returnStruct~Foo\" = call %Foo @\"_returnStruct~Foo\"()\n  call void @\"_Foo_b~void\"()\n  ret void\n}\n\ndefine void @\"_Foo_b~void\"() {\nentry:\n  ret void\n}\n"

